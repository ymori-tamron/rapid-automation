# **図面作成ツール刷新プロジェクト (Drawing Tool Refactoring Project)**

作成日: 2025年12月25日  
作成者: \[光学5部 森\]

## **1\. プロジェクトの背景 (Background)**

### **1.1 現状の運用**

現在、当社の光学レンズ製造プロセスにおいて、Excel VBA製「図面作成Tool」が基幹的な役割を果たしている。本ツールは、光学設計ソフト（CODE V等）が出力する設計データを取り込み、複雑な物理計算（サグ量、重量、芯取り代など）を経て、2D CADソフト「図脳RAPID」を自動制御し、製造用図面を生成している。

### **1.2 直面している課題**

本ツールは極めて高度な業務ロジックを内包しているにもかかわらず、以下の深刻な問題を抱えている。

* **極端な属人化:** 特定の開発者のみが仕様を把握しており、ソースコードの共有やドキュメント化が行われていない。  
* **ブラックボックス化:** レンズの形状計算や公差設定などの重要なエンジニアリングロジックがコード内に埋没しており、検証や修正が困難である。  
* **コミュニケーションの欠如:** 開発者との技術的な対話が困難な状況にあり、将来的なOSアップデート、CADのバージョンアップ、新規約への対応時に機能不全に陥るリスクが高い。

### **1.3 ビジネスリスク**

このまま放置した場合、当該開発者の退職や不在、あるいは技術的な環境変化によりツールが使用不能となった瞬間、**「図面作成業務が完全に停止する」**、あるいは\*\*「手計算・手作業への回帰により工数が数倍に膨れ上がり、品質ミスが多発する」\*\*という重大な経営リスク（BCP上の懸念）が存在する。

## **2\. プロジェクトの目的 (Objectives)**

本プロジェクトの主たる目的は、既存ツールの機能を維持しつつ、最新の技術スタック（Python）を用いて再構築することで、\*\*「技術資産の透明化」**と**「持続可能な開発体制の確立」\*\*を実現することである。

### **2.1 脱・属人化と透明性の確保**

* ソースコードをGit等でバージョン管理し、チーム全体でアクセス・修正可能な状態にする。  
* ブラックボックス化している「光学計算ロジック」を解析・ドキュメント化し、会社の技術資産として保全する。

### **2.2 持続可能性の向上 (Sustainability)**

* 開発言語をレガシーなVBAから、現代の標準でありライブラリも豊富な **Python** へ移行する。  
* 特定の個人に依存せず、将来的なエンジニアがメンテナンス・拡張しやすい構造にする。

### **2.3 業務効率と品質の向上**

* データ処理速度の向上（Pandas等の活用）により、処理時間を短縮する。  
* 最新のライブラリ活用により、将来的な機能拡張（3D CAD連携、データベース連携など）の基盤を作る。

## **3\. 現行システムの解析概要 (System Analysis)**

初期調査により判明した現行ツールの機能概要は以下の通りである。単なる作図効率化ツールではなく、**高度な技術計算アプリケーション**であることが判明している。

| カテゴリ | 機能概要 | 技術的難易度 |
| :---- | :---- | :---- |
| **データ入力** | 光学設計データ（.seqファイル）の正規表現によるパース処理 | 高 |
| **データ管理** | 硝材データベース（.csv/.xlsx）との照合・物性値取得 | 中 |
| **物理計算** | 非球面サグ量、レンズ重量（積分計算）、焦点距離、芯取り代の算出 | **極めて高い** |
| **CAD制御** | 図脳RAPIDのAPI (COM) を利用した自動作図、寸法記入、公差・注記の配置 | 高 |

特記事項:  
これら「物理計算ロジック」が失われることは、当社の設計・製造ノウハウの一部を失うことに等しい。

## **4\. 新システムの技術方針 (Technical Strategy)**

### **4.1 開発言語: Python**

* **選定理由:**  
  * 数値計算（NumPy）、データ処理（Pandas）に極めて強い。  
  * Windows API制御（pywin32）により、既存のCADソフト（図脳RAPID）をそのまま制御可能。  
  * エンジニア人口が多く、採用・教育が容易であるため、属人化を防ぎやすい。

### **4.2 開発体制とツール**

* **バージョン管理:** Git / GitHub (または社内GitLab)  
* **パッケージ管理:** uv (または Poetry) による再現性のある環境構築  
* **ドキュメンテーション:** コード内への型ヒント(Type Hinting)記述と、Sphinx/MkDocs等による仕様書の自動生成。

## **5\. ロードマップ (Roadmap)**

リスクを最小化するため、段階的に移行を進める。

* **Phase 1: コアロジックの移植と検証 (1～2ヶ月)**  
  * VBA内の計算関数（Sag, GlassWeight等）をPythonへ移植し、計算結果が完全に一致することを検証する（単体テストの整備）。  
  * 光学データ（.seq）の読み込み機能を実装する。  
* **Phase 2: CAD連携機能の実装 (2～3ヶ月)**  
  * Pythonから図脳RAPIDを操作し、線画や文字が描けるかの技術検証（PoC）。  
  * 主要な作図機能の実装。  
* **Phase 3: システム統合と並行運用 (1～2ヶ月)**  
  * UIの作成（CLIまたは簡易GUI）。  
  * 現行ツールとの並行運用を行い、出力結果に差異がないか確認する。  
* **Phase 4: 完全移行と保守運用**  
  * 現行ツールの廃止。  
  * マニュアル整備と社内展開。

## **6\. 期待される成果 (Expected Outcome)**

1. **事業リスクの排除:** ツール停止による業務停止リスクの解消。  
2. **ノウハウの継承:** ベテランの頭の中やVBAの中にあったロジックが、可読性の高いコードとドキュメントとして残る。  
3. **開発文化の変革:** 「隠す」開発から「共有する」開発へシフトし、チーム全体の技術力を底上げする。