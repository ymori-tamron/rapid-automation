## 🐍 コーディング規約

### 1. 命名規則
- **クラス**: `PascalCase` 
- **関数, メソッド, 変数**: `snake_case` 
- **定数**: `UPPER_CASE_SNAKE_CASE` 

---

### 2. Docstring
- **必須**: すべての公開モジュール、クラス、関数、メソッドにはDocstringを必ず記述してください。
- **形式**: **Googleスタイル**を厳守してください。
- **言語**: **日本語**で記述してください。
- **例**:
  ```python
  def refract_ray(
      incident_ray_direction: list[float],
      surface_normal: list[float],
      n_incident: float,
      n_refracted: float,
  ) -> list[float] | None:
      """屈折光線の方向を計算する。

      Args:
          incident_ray_direction (list[float]): 入射光線の方向ベクトル。
          surface_normal (list[float]): 表面の法線ベクトル。
          n_incident (float): 入射側の屈折率。
          n_refracted (float): 屈折側の屈折率。

      Returns:
          list[float] | None: 屈折光線の方向ベクトル。全反射の場合はNoneを返す。
      """
      pass
  ```
  
---

### 3. 型ヒント
- **必須**: すべての関数・メソッドの引数と戻り値には、`typing`モジュールを用いた型ヒントを必ず付けてください。Python 3.10以降の `|` を使った記法を推奨します。

---

### 4. コメント
- **言語**: コード中のコメントは日本語を使用してください。処理の意図が分かりにくい箇所には積極的にコメントを残してください。

---

### 5. ログ出力
- `logging`モジュールの使用：デバッグ目的の出力には `print()` を使わず、原則として `logging` モジュールを使用してください。
- ログレベルの適切な設定：情報レベルのログには `logging.info()`、警告には `logging.warning()`、エラーには `logging.error()` を使用してください。

---

## 📐 主要な概念と実装上の注意点

---

### 1. 実装の原則


- **クラス設計**: 状態を持つ単純なデータ構造には `@dataclass` を、共通インターフェースには `abc.ABC` を用いた抽象基底クラスを積極的に利用してください。
- **データ構造の選択**: 辞書型(`dict`)よりも`@dataclass`を推奨します。理由は以下の通り:
  - **型安全性**: 型ヒントにより IDE のサポートが効き、実装時のバグを減らせる。
  - **可読性**: フィールド名が明確で、コードの意図が伝わりやすい。
  - **保守性**: リファクタリングや将来のフィールド追加が容易。
  - **バリデーション**: `__post_init__` で初期化時の検証が可能。
  - 辞書型はキーのタイポや型の不一致に実行時まで気づけないリスクがあります。
- **エラーハンドリング**: 不正な引数などに対しては、`ValueError` や `TypeError` などの適切な例外を送出してください。
- **マジックナンバーの回避**: コード中に直接数値を記述せず、意味のある名前を持つ定数として定義してください（例: `EPSILON = 1e-12`）。

---

## ✅ テスト

- **フレームワーク**: `pytest` を使用します。
- **ファイル名**: `test_*.py` という命名規則に従ってください。
- **セットアップ**: テストデータの準備には `@pytest.fixture` を積極的に活用してください。